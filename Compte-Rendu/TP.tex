\documentclass{article}
\usepackage[french]{babel}
\usepackage[latin1]{inputenc}
\usepackage{array}
\usepackage{amsmath, amssymb}
\usepackage{tikz}
\usetikzlibrary{calc, shapes, backgrounds}
\usetikzlibrary{arrows}
\usepackage{mathrsfs}
\usepackage{float}
\usepackage{pgfplots}
\usepackage{enumerate}
\usepackage{caption}
\usepackage[ruled,vlined,french,onelanguage]{algorithm2e}
\title{TP Méthode approchées UMIN215}
\author{Bruno Y., Chlöé T., Julien D. et Rémi F.}

\begin{document}
\maketitle

\subsection*{Partie Théorique}

\subsubsection*{Exercice 1 - Sur le problème de la couverture sommet minimale : trois approches différentes}

\begin{enumerate}
\item
\begin{enumerate}[a)]
\item On a :
\begin{displaymath}
x_{i} = \begin{cases} 
0 \text{ si } x_{i} \notin S \\
1 \text{ si } x_{i} \in S
\end{cases}
\end{displaymath}

On peut donc déduire que le $(PL)$ donne bien une solution optimale. $z$ compte bien le nombre de sommets dans $S$. Si $(v_{r},v_{s}) \in E$, on a $x_{r}$ et $x_{s}$ qui valent $1$ : il faut qu'il y ait au moins un sommet couvre l'arête.

\item On ne peut pas avoir $x_{s} + x_{r} = 1 $ car $v_{r}$ et $v_{s}$ peuvent tout deux appartenir à S.

\item Soit une solution optimale, alors elle respecte les contraintes du $(PL)$ et correspond à un $z$ minimum: elle correspond donc à une solution du $(PL)$.

\item Supposons qu'il existe $(v_{r},v_{s})\in E$ tel que $x_{r} < \frac{1}{2}$ et $x_{s} < \frac{1}{2}$, alors on aurait $x_{r} + x_{s} < 1$, ce qui viole une contrainte. Donc $x_{r} \geq \frac{1}{2}$ ou $x_{s} \geq \frac{1}{2}$.

\item Soit $I$ une instance quelconque, alors on a $\rho = \frac{max(A(I))}{Opt(I)}$. Par ailleurs, on sait que :
\begin{equation}
 Opt(I) = S_{ILP}(I) 
\end{equation}
\begin{equation}
 S_{LP}(I) \leq S_{ILP}(I)
\end{equation}

On peut déduire de $(2)$ que $\frac{1}{S_{LP}(I)} \geq \frac{1}{S_{ILP}(I)}$. Donc on arrive à l'inéquation suivante : $\frac{A(I)}{S_{LP}(I)} \geq \frac{A(I)}{Opt(I)}$. Notons que $A(I)$ est la solution obtenue en arrondissant la solution de $S_{LP}(I)$. \\
On peut remarquer que puisqu'il existe $i$ tel que $x_{i} \geq \frac{1}{2} $, donc $2x_{i} \geq 1 $. On peut donc écrire : 

\begin{equation}
A(I) = \sum_{i, x_{i} \geq \frac{1}{2}} 1 \leq \sum_{i \in S^{*}} 2x_{i} \leq 2 \sum_{i=1}^{n} x_{i} = 2 Opt(I).
\end{equation}

On déduit finalement que $\frac{A(I)}{Opt(I)} = 2 $ et $\rho = \frac{max(A(I))}{Opt(I)} \leq 2 $
Montrons que $\rho = 2$ en considérons le cas suivant : 

\begin{figure}[H]
\center
\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]

  \node[main node] (1) { $\frac{1}{2} $};
  \node[main node] (2) [below left of=1] {  $\frac{1}{2} $};
  \node[main node] (3) [below right of=2] {  $\frac{1}{2} $};
  \node[main node] (4) [below right of=1] {  $\frac{1}{2} $};

  \path[every node/.style={font=\sffamily\small}]
    (1) edge [bend right] node[left] { }(2)
    (2) edge [bend right] node[left] { }(3)
    (3) edge [bend right] node[right] { }(4)
    (4)edge [bend right] node[right] { } (1);
\end{tikzpicture}
\caption{Résultat donné par l'Algorithme 1 pour le problème Vertex cover.}
\end{figure}

On peut remarquer qu'ici, $A(I) = 4 $ alors que $Opt(I) = 2 $.

\begin{figure}[H]
\center
\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]

  \node[main node] (1) { 1 };
  \node[main node] (2) [below left of=1] { 0};
  \node[main node] (3) [below right of=2] {  1};
  \node[main node] (4) [below right of=1] {  0};

  \path[every node/.style={font=\sffamily\small}]
    (1) edge [bend right] node[left] { }(2)
    (2) edge [bend right] node[left] { }(3)
    (3) edge [bend right] node[right] { }(4)
    (4)edge [bend right] node[right] { } (1);
\end{tikzpicture}
\caption{Résultat optimal pour le problème Vertex cover.}
\end{figure}

On peut donc finalement conclure que $\rho = \frac{max(A(I))}{Opt{I}} = 2 $.

\item 

\begin{enumerate}[i)]
\item Pour obtenir notre nouvel programme linéaire $(PL')$, il suffit simplement d'introduire les poids $w_{i} \in \mathbf{N}^{*}, i\in \{1, \dots , n \} $ et de poser $z = \sum_{j=1}^{n} w_{i} x_{i}$.

\begin{displaymath}
PL'\begin{cases} 
\text{min } z = \sum_{j=1}^{n} w_{i} x_{i} \\
x_{r} + x_{s} \geq 1, \forall \{v_{r},v_{s} \} \in E  \\
x_{j} \in \{0,1\}, j \in \{1, \dots, n \}
\end{cases}
\end{displaymath}


\item On peut remplacer le programme linéaire en nombre entiers $(PL')$ par un autre utilisant une matrice $A$. Pour un graphe $G=(V,E)$, la matrice $A$ utilisé dans le programme linéaire en nombres entiers possède les caractéristiques suivantes : 
\begin{itemize}
\item $A$ à $2*|E|$ lignes et $|V|$ colonnes.
\item Chaque ligne apparaît deux fois dans la matrice.
\item La matrice $A$ est constituée uniquement de $1$ et il n'y a que deux $1$ par ligne.
\end{itemize}

\begin{displaymath}
PL'\begin{cases} 
\text{min } z = \sum_{j=1}^{n} w_{i} x_{i} \\
A *  \left( \begin{array}{c}
x_1 \\
\vdots \\
x_n
\end{array} \right) \geq  \left( \begin{array}{c}
1 \\
\vdots \\
1
\end{array} \right). \\

x_{j} \in \{0,1\}, j \in \{1, \dots, n \}
\end{cases}
\end{displaymath}

\item A terminer..
\end{enumerate}
\end{enumerate}

\item \begin{enumerate}[a)]
\item Dans les pires des cas, les deux sommets de chaque arêtes sont pris : $A(I) \geq 2*m$ avec $m = |E|$. De plus, il y a toujours, au moins un sommet par arête dans la solution optimale : $Opt(I) \geq n $. On peut donc écrire que $\frac{1}{Opt(I)} \leq n$ et donc que $\frac{A(I)}{Opt(I)} \leq 2 $.

\item Considérons le graphe suivant :

\begin{figure}[H]
\center
\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]

  \node[main node] (1) { a };
  \node[main node] (2) [below left of=1] { b};
  \node[main node] (3) [below right of=2] {  c};
  \node[main node] (4) [below right of=1] {  d};

  \path[every node/.style={font=\sffamily\small}]
    (1) edge [bend right] node[left] { }(2)
    (2) edge [bend right] node[left] { }(3)
    (3) edge [bend right] node[right] { }(4)
    (4)edge [bend right] node[right] { } (1);
\end{tikzpicture}
\caption{Exemple d'instance pour lequel l'Algorithme 2 atteint la borne de deux.}
\end{figure}

On a donc $E' = ( \{a,b\}, \{a,d\}, \{b,c\}, \{c,d\} )$. 

\begin{figure}[H]
\center
\begin{tabular}{|c|c|c|c|}
\hline
\text{étape} & E' & \text{arête sélectionné} & C \\
\hline
1 & \{ \{a,b\}, \{a,d\}, \{b,c\}, \{c,d\} \} & \{a,b\} & \{ \{a,b\} \}\\
\hline
2 & \{ \{c,d\} \} & \{c,d\} & \{ \{a,b\}, \{c,d\} \}\\
\hline
3 & $\emptyset$ & $\emptyset$ & \{ \{a,b\}, \{c,d\} \} \\
\hline
\end{tabular}
\end{figure}

On à ici $A(I) = 4$ alors que $Opt(I) = 2 $ donc $rho = \frac{max(A(I))}{Opt(I)} = 2 $.

\item On commence par prendre les $\frac{k!}{k}$ sommets de degrés $k$ (les triangles), puis les $\frac{k!}{k-1}$ sommets de degrés $k-1$, etc.. On va donc prendre en tout $k! \sum_{i=0}^{k} \frac{1}{k-i} = k! \sum_{i=1}^{k} \frac{1}{i} = k! * H_{k}$, avec $H_{k}$ la k-ième somme partielle de la série harmonique. L'optimal est de prendre que les $k!$ sommets de degrés $k$ (les carrés). On a donc pour un $k$ fixé, $\frac{A(I)}{Opt(I)} = H_{k}$. Or si $k \rightarrow \infty$, $H_{k}$ diverge et tend vers $\infty$.
\end{enumerate}

\end{enumerate}
\subsubsection*{Exercice 2 - Sur le problème du couplage maximum de poids minimum : un début d'étude polyédrale sur le problème de couplage}

\subsubsection*{Exercice 3 - Sur le problème de la coupe maximum}

\subsubsection*{Exercice 4 - Sur le problème de Partition}

\subsubsection*{Exercice 5 - Sur le problème du sac à  dos simple}

\subsubsection*{Exercice 6 - Programmation dynamique}

\subsubsection*{Exercice 7 - Sur le produit matriciel}

\subsubsection*{Exercice 8 - Résolution numérique}

\subsubsection*{Exercice 9 - Seuil d'approximation pour le problème Bin Packing}

\subsubsection*{Exercice 10 - Seuil d'approximation pour le problème de la coloration de sommets (reps. d'arêtes)}

\newpage
\subsubsection*{Exercice 11 - Comparaisons branch and bound and branch and cut}

\begin{enumerate}
\item On peut tracer les droites correspondantes aux contraintes de $PL_{0}$ :
\begin{itemize}
\item {$y_{1}=5-\frac{3}{2}x$}
\item {$y_{2}=\frac{17}{2}-\frac{2}{5}x$}
\end{itemize}

\begin{figure}[h]
\centering
\begin{tikzpicture}[>=stealth]
    \begin{axis}[
        xmin=0,xmax=10,
        ymin=0,ymax=6,
        axis x line=middle,
        axis y line=middle,
        axis line style=->,
        xlabel={$x$},
        ylabel={$y$},
        ]
        \addplot[no marks,black,-] expression[domain=0:10/3,samples=100]{5-(3/2)*x} 
                    node[pos=0.65,anchor=south west]{$y_{1}=5-\frac{3}{2}x$}; 
        \addplot[no marks,black,-] expression[domain=0:17/2,samples=100]{17/5-(2/5)*x} 
                    node[pos=0.65,anchor=south west]{$y_{2}=\frac{17}{5}-\frac{2}{5}x$}; 
    \end{axis}
\end{tikzpicture}
   \caption{Représentation des équations de $PL_{0}$.}
\end{figure}

Le polytope associé aux équations de $PL_{0}$ est donc celui formé par les points : $P_{0}(0,0)$, $P_{1}(0,\frac{17}{5})$, $P_{2}(\frac{16}{11}, \frac{31}{11})$ et $P_{3}(\frac{10}{3},0)$

\item On peut tracer la fonction objective :
\begin{itemize}
\item $y=-2x+k, k \in \mathbf{R}$ (rouge)
\end{itemize}

\begin{tikzpicture}[>=stealth]
    \begin{axis}[
        xmin=0,xmax=10,
        ymin=0,ymax=6,
        axis x line=middle,
        axis y line=middle,
        axis line style=->,
        xlabel={$x$},
        ylabel={$y$},
        ]
        \addplot[no marks,black,-] expression[domain=0:10/3,samples=100]{5-(3/2)*x} 
                    node[pos=0.65,anchor=south west]{$y_{1}=5-\frac{3}{2}x$}; 
        \addplot[no marks,blue,-] expression[domain=0:17/2,samples=100]{17/5-(2/5)*x} 
                    node[pos=0.65,anchor=south west]{$y_{2}=\frac{17}{5}-\frac{2}{5}x$}; 
                    
	 \addplot[no marks,red,-] expression[domain=0:17/2,samples=100]{-2*x+20/3} 
                    node[pos=0.65,anchor=south west]{Fonction objective}; 
    \end{axis}
\end{tikzpicture}

La solution optimale pour $PL_{0}$ est donc $x_{1}=\frac{10}{3}$ et $x_{2}={0}$ avec $z=\frac{20}{3}$.

\item On commence par reprendre le programme linéaire donné :
\begin{displaymath}
PL_{0}\begin{cases} 
\text{max } z(x_{1},x_{2})=2x_{1}+x_{2} \\
2x_{1}+5x_{2} \leq 17 \\
3x_{1}+2x_{2} \leq 10 \\
x_{1}, x_{2} \geq 0
\end{cases}
\end{displaymath}
On ajoute les variables d'écarts $x_{3}$ et $x_{4}$ pour obtenir $PL_{1}$ :

\begin{displaymath}
PL_{1}\begin{cases} 
\text{max } z(x_{1},x_{2})=2x_{1}+x_{2} \\
2x_{1}+5x_{2} + x_{3} = 17 \\
3x_{1}+2x_{2} + x_{4} = 10 \\
x_{1}, x_{2} \geq 0
\end{cases}
\end{displaymath}

On obtient donc le tableau initial : \\
\begin{tabular}{|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|}
   \hline
  \multicolumn{3}{|c|}{} & 2 & 1 & 0 & 0\\
     \hline
   & && $x_{1}$&$x_{2}$ &$x_{3}$ &$x_{4}$\\
   \hline
   0&$x_{3}$ &17& 2&5 &1 &0\\
   \hline
   0&$x_{4}$ & 10 &3 & 2&0 &1\\
   \hline
      & $z$& 0&-2 &-1 &0 &0\\
      \hline
\end{tabular}

La variable entrante est $x_{1}$ et la variable sortante est $x_{4}$. 
Le tableau final est donc : \\
\begin{tabular}{|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|}
   \hline
  \multicolumn{3}{|c|}{} & 2 & 1 & 0 & 0\\
   \hline
   & && $x_{1}$&$x_{2}$ &$x_{3}$ &$x_{4}$\\
   \hline
   0&$x_{3}$ &$\frac{31}{3}$& 0&$\frac{11}{3} $&1 &$\frac{-2}{3}$\\
   \hline
   2&$x_{1}$ & $\frac{10}{3}$ &1 & $\frac{2}{3}$&0 & $\frac{1}{3}$\\
   \hline
      & $z$& $\frac{20}{3}$&0 &$\frac{1}{3}$ &0 &$\frac{2}{3}$\\
      \hline
\end{tabular}

La solution optimale est donc $x_{1}=\frac{10}{3}$ et $x_{2}={0}$ avec $z=\frac{20}{3}$.

\item

\begin{enumerate}[a)]
\item

On effectue notre Branch and Bound dans l'ordre : $x_{1}$ puis $x_{2}$. Puisque dans la solution optimale du $(PL)$, $x_{1} = \frac{20}{3}$, on a $x_{1} \leq 3$ ou que $x_{1} \geq 4 $. 
\begin{itemize}
\item Si l'on considère que $x_{1} \leq 3$, la solution optimale devient $z=\frac{13}{2}$ avec $x_{1}=3$ et $x_{2} = \frac{1}{2}$. On a ensuite, $x_{2} = 0$ ou $x_{2} > 0$. \\
\begin{itemize}
\item Si l'on considère que $x_{2}=0$, alors la solution optimale devient $z=6$ avec $x_{1}=3$ et $x_{2}=0$.
\item Si l'on considère que $x_{2} \geq 1$, alors la solution optimale devient $z= \frac{19}{3} \approx 6.33$ avec $x_{1} = \frac{8}{3}$ et $x_{2} = 1$. On ne développe pas plus cette branche puisque l'on à déjà trouvé une solution avec $z=6$.
\end{itemize}
\item Si l'on considère que $x_{1} \geq 4$, la deuxième contrainte est violée.
\end{itemize}
L'arbre du Branch and bound récapitulatif est donné plus bas.

\tikzset{
  head/.style = {fill = orange!90!blue,
                 label = center:\textsf{\Large H}},
  tail/.style = {fill = blue!70!yellow, text = black,
                 label = center:\textsf{\Large T}}
}
\begin{tikzpicture}[
    scale = 1.5, transform shape, thick,
    every node/.style = {draw, circle, minimum size = 10mm},
    grow = down,  % alignment of characters
    level 1/.style = {sibling distance=3cm},
    level 2/.style = {sibling distance=4cm}, 
    level 3/.style = {sibling distance=2cm}, 
    level distance = 1.25cm
  ]
  \node[fill = gray!40, shape = rectangle, rounded corners,
    minimum width = 6cm, font = \sffamily] { Valeur de $S_{LP}$} 
  child { node[{fill = orange,
                 label = center:\textsf{ $\frac{20}{3} $}}] (Start){}
   child {   node [{fill = orange,
                 label = center:\textsf{ $6.5_{1}$}}] (A) {}
     child { node [{fill = orange,
                 label = center:\textsf{ $6_{2}$}}] (B) {}}
     child { node [{fill = orange,
                 label = center:\textsf{ $(\frac{19}{3})_{3}$}}] (C) {}}
   }
   child {   node [{fill = orange,
                 label = center:\textsf{ $\emptyset_{4}$}}] (D) {}}
  };

  % Labels des arêtes
  \begin{scope}[nodes = {draw = none}]
    \path (Start) -- (A) node [near start, left]  {$x_{1} \leq 3$};
    \path (A)     -- (B) node [near start, left]  {$x_{2} =0 $};
    \path (A)     -- (C) node [near start, right] {$x_{2} \geq 1$};
    \path (Start) -- (D) node [near start, right] {$x_{1} \geq 4$};
    \begin{scope}[nodes = {below = 11pt}]
      \node            at (C) {Plus grand};
      \node            at (D) {Contrainte violée};
    \end{scope}
  \end{scope}
\end{tikzpicture}

\item
Puisque que l'on a $\frac{31}{3} = \frac{11}{3} x_{2} + x_{3} - \frac{2}{3} x_{4} $, on peut déduire que : $ \frac{11}{3} x_{2} - \frac{2}{3} x_{4} \geq \frac{1}{3} $. \\
Puisque l'on a $\frac{10}{3} = x_{1} + \frac{2}{3} x_{2} + \frac{1}{3}x_{4}$ , on peut donc déduire que $x_{4}=10 - 3x_{1} - 2x_{2}$. \\
On obtient finalement la contrainte : $2x_{1} + 5x_{2} \geq 7$. 

Le tableau final donne :

\begin{tabular}{|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|}
   \hline
  \multicolumn{3}{|c|}{} & 2 & 1 & 0 & 0 & 0\\
   \hline
   & 	&	& $x_{1}$	&	$x_{2}$ 	&$x_{3}$ &$x_{4}$ & $x_{5}$\\
   \hline
0&$x_{3}$& 10  &     0 &     0      &1      &0   &   1         \\
2&$x_{1}$& $\frac{36}{11}$ &  1 &     0   &   0 &     $\frac{5}{11}$&   $\frac{2}{11}$    \\    
1&$x_{2}$&  $\frac{1}{11} $ &  0    &  1     & 0     & $\frac{-2}{11} $ & $\frac{-3}{11}  $   \\  
&z&  $\frac{73}{11}$&  0    &  0    &  0     & $\frac{8}{11} $ & $\frac{1}{11}$   \\
      \hline
\end{tabular}

On choisi l'équation $\frac{36}{11} = x_{1} + \frac{5}{11} x_{4} + \frac{2}{11}x_{5}$, on déduit donc $\frac{5}{11} x_{4} + \frac{2}{11}x_{5} \geq \frac{3}{11}$. Ce qui revient à écrire par l'équation précédente que $\frac{36}{11} - x_{1} \geq \frac{3}{11}$ et donc que $x_{1} \leq 3$. 

\begin{tabular}{|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|p{0.75cm}|}
   \hline
  \multicolumn{3}{|c|}{} & 2 & 1 & 0 & 0 & 0 & 0\\
   \hline
   & 	&	& $x_{1}$	&	$x_{2}$ 	&$x_{3}$ &$x_{4}$ & $x_{5}$ & $x_{6}$\\
   \hline
0&$x_{3}$& $\frac{17}{2}$&     0 &     0      &1      &$\frac{-5}{2} $  &   0 & $\frac{11}{2}   $      \\
0&$x_{4}$& $\frac{3}{2}$ &  0 &     0   &   0 &     $\frac{5}{2}$& 1 &  $\frac{-11}{2}$    \\    
1&$x_{2}$&  $\frac{1}{2} $ &  0    &  1     & 0     & $\frac{1}{2} $ & 0 & $\frac{-3}{2} $  \\  
2&$x_{1}$&  3                &  1    &  0    & 0     & 0 & 0& 1   \\  
&z&  $\frac{13}{2}$           &  0    &  0    &  0     & $\frac{1}{2} $& 0 & $\frac{1}{2}$   \\
      \hline
\end{tabular}

On sélectionne l'équation $\frac{1}{2} = x_{2} + \frac{1}{2} x_{4} - \frac{3}{2} x_{6}$. Donc on déduit que $\frac{1}{2} \leq \frac{-3}{2}x_{6}$
\end{enumerate}
\end{enumerate}
\subsection*{Partie Pratique}

\subsubsection*{2.1 Programmation dynamique}

\subsubsection*{2.2 Branch and Bound}

\subsubsection*{2.3 Comparaisons entre un algorithme de complexité exponentielle et un FP-TAS}

\end{document}
